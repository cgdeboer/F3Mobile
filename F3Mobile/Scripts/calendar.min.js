define(["jquery","toastr","moment","text!templates/currentweekitem.html","text!templates/aoTemplate.html","text!templates/firstf.html","mustache","underscore","calendarService"],function(n,t,i,r,u,f,e,o,s){function b(t){s.initialize({calSvcUrl:t.calSvcUrl,calListUrl:t.calListUrl});v(!1);n(".nav-tabs").bind("click",function(n){n.target.text==="All"?v(!0):n.target.text==="This Week"?v(!1):nt()});n("#workout").change(function(){var t=n(this).find("option:selected").val();t==="All"?n("div.ao").show():(n("div.ao").hide(),n("div.ao[data-name='"+t+"']").show())})}function k(n){var u=i(),t=i().startOf("week"),r=i().endOf("week");return n.isBetween(t,r)}function d(t){var r=o.sortBy(t?l:c,"summary"),s=n("#itemHolder"),f;n.each(r,function(t,r){r.items=o.sortBy(r.items,"Start.Date");n.each(r.items,function(n,t){var u=t.Start.Date===null?i(t.Start.DateTime):i(t.Start.Date),f;k(u)&&(f={name:r.name,description:t.Summary,date:u.format("MM/DD/YYYY"),location:r.Summary},a.push(f));t.displayDate=u.format("MM/DD/YYYY")})});t?(f=e.to_html(u,r),s.html(f)):g()}function g(){var t=o.sortBy(a,"date"),i=e.to_html(r,t);n("#currentWeekItems").html(i)}function p(n){console&&console.log&&console.log(n)}function nt(){if(y==!1&&h&&h.Items&&h.Items.length>0){n("#loading-firstf").hide();n.each(h.Items,function(n,t){try{var i=JSON.parse(t.Description);t.SiteQ=i.SiteQ;t.Meets=i.Meets;t.LocationHint=i.LocationHint;t.DisplayLocation=i.DisplayLocation;t.Time=i.Time}catch(r){t.SiteQ=t.Description;t.Meets=t.Description;t.LocationHint=null;t.DisplayLocation=t.Location||"";t.Time=""}});var t=o(h.Items).chain().sortBy(function(n){return n.Summary}).sortBy(function(n){var t=o.findWhere(w,{day:n.Meets});return t?t.val:""}).value(),i=e.to_html(f,t);n("#firstF").append(i);y=!0}}function v(t){n("#loading-"+(t?"all":"current")).show();var i=[];s.getList(function(r){h=r;n.each(h.Items,function(r,u){var f=n.Deferred();i.push(f);tt(u,t,h,function(){f.resolve()})});n.when.apply(this,i).done(function(){d(t);p("all done");n("#loading-"+(t?"all":"current")).hide()})},function(){console.log("unable to get list")})}function tt(n,t,i,r){var u=o.findWhere(i.Items,{Id:n.Id});l=[];c=[];a=[];s.getEvents(n.Id,t,function(i){p("success get: "+n.name);var f={id:n.Id,summary:i.Summary,name:n.Summary,items:i.Items,location:u.Location||""};t?l.push(f):c.push(f);r()},function(){r()})}var c=[],l=[],a=[],h=[],y=!1,w=[{val:0,day:"Monday"},{val:1,day:"Tuesday"},{val:2,day:"Wednesday"},{val:3,day:"Thursday"},{val:4,day:"Friday"},{val:5,day:"Saturday"},{val:6,day:"Sunday"}];return{initialize:b}});
//# sourceMappingURL=calendar.min.js.map
